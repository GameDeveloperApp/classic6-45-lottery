<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="theme-color" content="#0a5c36">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>üé∞ –ö–ª–∞—Å—Å–∏–∫–∞ 6/45 - Telegram Lottery</title>
    <style>
         /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f7;
            color: #333;
            overflow-x: hidden;
        }

        #root {
            min-height: 100vh;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.hidden {
            display: none;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            position: relative;
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 480px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease-out;
            z-index: 1001;
        }

        .win-modal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .lose-modal {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .modal-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .star-icon, .sad-icon {
            font-size: 1.8rem;
            animation: pulse 2s infinite;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 2rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 20px 24px 24px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–∏–ª–µ—Ç–∞ */
        .ticket-result {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .win-ticket {
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }

        .lose-ticket {
            border-color: rgba(255, 255, 255, 0.5);
        }

        .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        .ticket-type {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .ticket-id {
            font-family: 'Roboto Mono', monospace;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .ticket-prize {
            text-align: center;
            margin: 25px 0;
        }

        .prize-amount {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .prize-amount.lose {
            opacity: 0.7;
            font-size: 2.5rem;
        }

        .stars-icon {
            font-size: 2.5rem;
            animation: shine 3s infinite;
        }

        .prize-label {
            margin-top: 10px;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .ticket-details {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            opacity: 0.8;
            font-weight: 500;
        }

        .detail-value {
            font-weight: 600;
            font-family: 'Roboto Mono', monospace;
        }

        .win-combination {
            color: #ffd700;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .lose-combination {
            color: #ff6b6b;
            font-weight: 700;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .win-message, .lose-message {
            text-align: center;
            padding: 20px;
            font-size: 1.1rem;
            line-height: 1.6;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-top: 20px;
        }

        .win-message p:first-child {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 14px 24px;
            border-radius: 12px;
            border: none;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
            min-width: 140px;
        }

        .btn-primary {
            background: #ffd700;
            color: #333;
        }

        .btn-primary:hover {
            background: #ffed4a;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .btn-outline:hover {
            border-color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .btn-icon {
            font-size: 1.2rem;
        }

        /* –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ –¥–ª—è –≤—ã–∏–≥—Ä—ã—à–∞ */
        .confetti {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 20px;
            background: #ffd700;
            top: 0;
            opacity: 0;
            animation: confetti-fall 5s linear infinite;
        }

        .confetti-piece:nth-child(1) {
            left: 10%;
            animation-delay: 0s;
            background: #ff6b6b;
        }

        .confetti-piece:nth-child(2) {
            left: 20%;
            animation-delay: 0.5s;
            background: #4ecdc4;
        }

        .confetti-piece:nth-child(3) {
            left: 30%;
            animation-delay: 1s;
            background: #ffd166;
        }

        .confetti-piece:nth-child(4) {
            left: 40%;
            animation-delay: 1.5s;
            background: #06d6a0;
        }

        .confetti-piece:nth-child(5) {
            left: 50%;
            animation-delay: 2s;
            background: #118ab2;
        }

        .confetti-piece:nth-child(6) {
            left: 60%;
            animation-delay: 2.5s;
            background: #ef476f;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes shine {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.6;
            }
        }

        @keyframes confetti-fall {
            0% {
                top: -10%;
                opacity: 1;
                transform: rotate(0deg);
            }
            100% {
                top: 100%;
                opacity: 0;
                transform: rotate(360deg);
            }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 640px) {
            .modal-content {
                margin: 10px;
                max-height: 85vh;
            }

            .modal-footer {
                flex-direction: column;
            }

            .btn {
                min-width: 100%;
            }

            .prize-amount {
                font-size: 2.5rem;
            }

            .stars-icon {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .modal-header {
                padding: 20px 20px 12px;
            }

            .modal-body {
                padding: 20px;
            }

            .modal-footer {
                padding: 16px 20px 20px;
            }

            .modal-title {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- –ü—Ä–µ–ª–æ–∞–¥–µ—Ä -->
    <div id="preloader" class="preloader">
        <div class="loader"></div>
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</p>
    </div>

    <div class="lottery-container">
        <!-- ... (–í–µ—Å—å HTML-–∫–æ–¥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->
        <!-- –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—é–¥–∞ –≤–µ—Å—å –±–ª–æ–∫ .lottery-container –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ -->
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —á–∏—Å–µ–ª -->
    <div id="numbersModal" class="numbers-modal">
        <!-- ... (–ö–æ–¥ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏) ... -->
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ -->
    <div id="rulesModal" class="rules-modal">
        <!-- ... (–ö–æ–¥ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏) ... -->
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–∏–≥—Ä—ã—à–∞ -->
    <div id="winModal" class="result-modal">
        <!-- ... (–ö–æ–¥ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏) ... -->
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–∏–≥—Ä—ã—à–∞ -->
    <div id="loseModal" class="result-modal">
        <!-- ... (–ö–æ–¥ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏) ... -->
    </div>

    <script>
        // ==================== API –ù–ê–°–¢–†–û–ô–ö–ò ====================
        const API_BASE_URL = 'https://classic6-45-lottery-api.vercel.app';

        // ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò–ì–†–´ ====================
        const GAME_CONFIG = {
            totalNumbers: 45,
            numbersToSelect: 6,
            ticketPrice: 100,
            drawInterval: 10, // –º–∏–Ω—É—Ç
            drawDuration: 2, // –º–∏–Ω—É—Ç
            initialJackpot: 50000,
            jackpotIncrementPercentage: 0.5, // 50% –æ—Ç –±–∏–ª–µ—Ç–∞ –∏–¥–µ—Ç –≤ –¥–∂–µ–∫–ø–æ—Ç

            prizes: {
                3: 100,
                4: 1000,
                5: 50000,
                6: 'jackpot' // –≤–µ—Å—å –¥–∂–µ–∫–ø–æ—Ç
            }
        };

        // ==================== –ö–õ–ê–°–° –ò–ì–†–´ –° –ù–ï–ü–†–ï–†–´–í–ù–´–ú–ò –¢–ò–†–ê–ñ–ê–ú–ò ====================
        class Classic6_45Continuous {
            constructor() {
                this.selectedNumbers = new Set();
                this.userTickets = [];
                this.currentTiraj = null;
                this.nextDrawTime = null;
                this.drawStatus = 'waiting';
                this.jackpotAmount = GAME_CONFIG.initialJackpot;
                this.isTelegramApp = false;
                this.telegramUserId = null;
                this.telegramBalance = 0;
                this.drawInterval = null;

                this.init();
            }

            async init() {
                console.log("üé∞ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã —Å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º–∏ —Ç–∏—Ä–∞–∂–∞–º–∏...");

                this.checkTelegramEnvironment();
                await this.loadCurrentTiraj();
                await this.loadJackpot();
                this.initNumberGrid();
                this.startContinuousDrawSystem();
                this.updateUI();

                console.log("‚úÖ –ò–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞! –¢–µ–∫—É—â–∏–π —Ç–∏—Ä–∞–∂:", this.currentTiraj?.id);
            }

            // ==================== –†–ê–ë–û–¢–ê –° –ë–≠–ö–ï–ù–î–û–ú ====================

            async loadCurrentTiraj() {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/v1/tiraj/current`);
                    if (response.ok) {
                        const data = await response.json();
                        this.currentTiraj = data;
                        this.nextDrawTime = new Date(data.nextDrawTime);
                        this.drawStatus = data.status;
                        this.updateTimerDisplay();
                        return data;
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ç–∏—Ä–∞–∂–∞:', error);
                    // –°–æ–∑–¥–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–∏—Ä–∞–∂ –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
                    await this.createDefaultTiraj();
                }
                return null;
            }

            async createDefaultTiraj() {
                const now = new Date();
                const nextDraw = new Date(now.getTime() + GAME_CONFIG.drawInterval * 60000);

                this.currentTiraj = {
                    id: 1,
                    status: 'waiting',
                    nextDrawTime: nextDraw.toISOString(),
                    drawDuration: GAME_CONFIG.drawDuration * 60,
                    jackpot: this.jackpotAmount,
                    ticketPrice: GAME_CONFIG.ticketPrice
                };

                this.nextDrawTime = nextDraw;
            }

            async loadJackpot() {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/v1/jackpot`);
                    if (response.ok) {
                        const data = await response.json();
                        this.jackpotAmount = data.amount;
                        this.updateJackpotDisplay();
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∂–µ–∫–ø–æ—Ç–∞:', error);
                }
            }

            async buyTicket() {
                if (this.selectedNumbers.size !== GAME_CONFIG.numbersToSelect) {
                    this.showNotification(`–ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ä–æ–≤–Ω–æ ${GAME_CONFIG.numbersToSelect} —á–∏—Å–µ–ª`);
                    return;
                }

                if (this.drawStatus === 'drawing') {
                    this.showNotification('‚ùå –ü—Ä–∏–µ–º —Å—Ç–∞–≤–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω! –¢–∏—Ä–∞–∂ —É–∂–µ –Ω–∞—á–∞–ª—Å—è');
                    return;
                }

                const ticketId = this.generateTicketId();
                const numbers = Array.from(this.selectedNumbers).sort((a, b) => a - b);

                try {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–∫—É–ø–∫—É –±–∏–ª–µ—Ç–∞
                    const response = await fetch(`${API_BASE_URL}/api/v1/tickets/buy`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': this.getAuthToken()
                        },
                        body: JSON.stringify({
                            telegramUserId: this.telegramUserId,
                            numbers: numbers,
                            tirajId: this.currentTiraj.id,
                            ticketId: ticketId,
                            ticketPrice: GAME_CONFIG.ticketPrice
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∏–ª–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
                        const ticket = {
                            id: ticketId,
                            tirajId: this.currentTiraj.id,
                            numbers: numbers,
                            purchaseTime: new Date().toISOString(),
                            drawTime: this.nextDrawTime.toISOString(),
                            winningNumbers: [],
                            matchedNumbers: [],
                            winAmount: 0,
                            status: 'pending',
                            formattedId: this.formatTicketId(ticketId),
                            formattedTirajId: this.formatTirajId(this.currentTiraj.id),
                            serverTicketId: result.ticketId
                        };

                        this.userTickets.unshift(ticket);

                        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∂–µ–∫–ø–æ—Ç (50% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –±–∏–ª–µ—Ç–∞)
                        this.jackpotAmount += GAME_CONFIG.ticketPrice * GAME_CONFIG.jackpotIncrementPercentage;
                        this.updateJackpotDisplay();

                        // –û–±–Ω–æ–≤–ª—è–µ–º UI
                        this.updateTicketsDisplay();
                        this.showNotification(`üé´ –ë–∏–ª–µ—Ç ${ticket.formattedId} –∫—É–ø–ª–µ–Ω! –¢–∏—Ä–∞–∂ ${ticket.formattedTirajId}`);

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∏–ª–µ—Ç –≤ localStorage
                        this.saveLocalTickets();

                        // –û—á–∏—â–∞–µ–º –≤—ã–±–æ—Ä
                        this.clearSelection();
                        setTimeout(() => hideNumbersModal(), 1000);

                        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∂–µ–∫–ø–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                        await this.updateJackpotOnServer();

                    } else {
                        throw new Error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–∞');
                    }

                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–∞:', error);
                    this.showNotification('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–∞');
                }
            }

            async updateJackpotOnServer() {
                try {
                    await fetch(`${API_BASE_URL}/api/v1/jackpot/update`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            amount: this.jackpotAmount
                        })
                    });
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∂–µ–∫–ø–æ—Ç–∞:', error);
                }
            }

            // ==================== –ù–ï–ü–†–ï–†–´–í–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –¢–ò–†–ê–ñ–ï–ô ====================

            startContinuousDrawSystem() {
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—Å–ª–∏ –µ—Å—Ç—å
                if (this.drawInterval) {
                    clearInterval(this.drawInterval);
                }

                // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
                this.drawInterval = setInterval(() => {
                    this.updateDrawSystem();
                }, 1000);
            }

            updateDrawSystem() {
                const now = new Date();
                const timeDiff = this.nextDrawTime - now;

                if (timeDiff <= 0) {
                    // –í—Ä–µ–º—è —Ç–∏—Ä–∞–∂–∞ –Ω–∞—Å—Ç—É–ø–∏–ª–æ
                    if (this.drawStatus === 'waiting') {
                        this.startDrawing();
                    }

                    const drawTimePassed = Math.abs(timeDiff) / 1000;
                    const drawTimeLeft = GAME_CONFIG.drawDuration * 60 - drawTimePassed;

                    if (drawTimeLeft <= 0) {
                        // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–∏—Ä–∞–∂
                        this.finishDrawing();
                    } else {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä —Ä–æ–∑—ã–≥—Ä—ã—à–∞
                        this.updateTimerDisplay('drawing', drawTimeLeft);
                    }
                } else {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–∏—Ä–∞–∂–∞
                    this.updateTimerDisplay('waiting', timeDiff / 1000);
                }
            }

            async startDrawing() {
                console.log(`üé∞ –ù–∞—á–∞–ª–æ —Ç–∏—Ä–∞–∂–∞ ${this.currentTiraj.id}`);
                this.drawStatus = 'drawing';

                try {
                    // –£–≤–µ–¥–æ–º–ª—è–µ–º —Å–µ—Ä–≤–µ—Ä –æ –Ω–∞—á–∞–ª–µ —Ç–∏—Ä–∞–∂–∞
                    await fetch(`${API_BASE_URL}/api/v1/tiraj/${this.currentTiraj.id}/start`, {
                        method: 'POST'
                    });

                    this.showNotification(`üé∞ –¢–∏—Ä–∞–∂ ${this.formatTirajId(this.currentTiraj.id)} –Ω–∞—á–∞–ª—Å—è!`);

                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –Ω–∞—á–∞–ª–∞ —Ç–∏—Ä–∞–∂–∞:', error);
                }
            }

            async finishDrawing() {
                console.log(`üé∞ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–∏—Ä–∞–∂–∞ ${this.currentTiraj.id}`);

                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —á–∏—Å–ª–∞
                const winningNumbers = this.generateWinningNumbers();

                try {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —á–∏—Å–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                    const response = await fetch(`${API_BASE_URL}/api/v1/tiraj/${this.currentTiraj.id}/finish`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            winningNumbers: winningNumbers
                        })
                    });

                    if (response.ok) {
                        const tirajResult = await response.json();

                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∏–ª–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —ç—Ç–æ–≥–æ —Ç–∏—Ä–∞–∂–∞
                        await this.checkUserTickets(this.currentTiraj.id, winningNumbers);

                        // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç–∏—Ä–∞–∂
                        await this.prepareNextTiraj();

                        this.showNotification(`‚úÖ –¢–∏—Ä–∞–∂ ${this.formatTirajId(this.currentTiraj.id)} –∑–∞–≤–µ—Ä—à–µ–Ω! –í—ã–ø–∞–ª–∏ —á–∏—Å–ª–∞: ${winningNumbers.join(', ')}`);

                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ç–∏—Ä–∞–∂–µ–π
                        await this.loadTirajHistory();

                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–∏—Ä–∞–∂–∞:', error);
                    // –í—Å–µ —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç–∏—Ä–∞–∂—É
                    await this.prepareNextTiraj();
                }
            }

            async prepareNextTiraj() {
                try {
                    // –°–æ–∑–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç–∏—Ä–∞–∂ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                    const response = await fetch(`${API_BASE_URL}/api/v1/tiraj/create-next`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            previousTirajId: this.currentTiraj.id,
                            jackpot: this.jackpotAmount
                        })
                    });

                    if (response.ok) {
                        const nextTiraj = await response.json();
                        this.currentTiraj = nextTiraj;
                        this.nextDrawTime = new Date(nextTiraj.nextDrawTime);
                        this.drawStatus = 'waiting';

                        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        this.updateTimerDisplay('waiting', (this.nextDrawTime - new Date()) / 1000);
                        this.updateCurrentTirajDisplay();

                        console.log(`üîÑ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω —Å–ª–µ–¥—É—é—â–∏–π —Ç–∏—Ä–∞–∂ ${nextTiraj.id}`);
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–∏—Ä–∞–∂–∞:', error);
                    // –°–æ–∑–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç–∏—Ä–∞–∂ –ª–æ–∫–∞–ª—å–Ω–æ
                    this.createNextTirajLocally();
                }
            }

            createNextTirajLocally() {
                const nextId = this.currentTiraj.id + 1;
                const nextDraw = new Date();
                nextDraw.setMinutes(nextDraw.getMinutes() + GAME_CONFIG.drawInterval);

                this.currentTiraj = {
                    id: nextId,
                    status: 'waiting',
                    nextDrawTime: nextDraw.toISOString(),
                    drawDuration: GAME_CONFIG.drawDuration * 60,
                    jackpot: this.jackpotAmount,
                    ticketPrice: GAME_CONFIG.ticketPrice
                };

                this.nextDrawTime = nextDraw;
                this.drawStatus = 'waiting';

                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                this.updateCurrentTirajDisplay();
            }

            async checkUserTickets(tirajId, winningNumbers) {
                const tirajTickets = this.userTickets.filter(t => t.tirajId === tirajId);

                for (const ticket of tirajTickets) {
                    const matchedNumbers = ticket.numbers.filter(num => winningNumbers.includes(num));
                    ticket.winningNumbers = winningNumbers;
                    ticket.matchedNumbers = matchedNumbers;

                    if (matchedNumbers.length >= 3) {
                        ticket.status = 'win';
                        ticket.winAmount = this.calculateWinAmount(matchedNumbers.length);

                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∏–≥—Ä—ã—à–∞
                        setTimeout(() => this.showWinResult(ticket), 500);

                        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∂–µ–∫–ø–æ—Ç –µ—Å–ª–∏ –≤—ã–∏–≥—Ä—ã—à –¥–∂–µ–∫–ø–æ—Ç
                        if (matchedNumbers.length === 6) {
                            this.jackpotAmount = GAME_CONFIG.initialJackpot;
                            await this.updateJackpotOnServer();
                        }
                    } else {
                        ticket.status = 'lose';
                        setTimeout(() => this.showLoseResult(ticket), 500);
                    }

                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                    await this.saveTicketResult(ticket);
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                this.updateTicketsDisplay();
                this.saveLocalTickets();
            }

            calculateWinAmount(matchedCount) {
                if (matchedCount === 6) {
                    return this.jackpotAmount;
                }
                return GAME_CONFIG.prizes[matchedCount] || 0;
            }

            async saveTicketResult(ticket) {
                try {
                    await fetch(`${API_BASE_URL}/api/v1/tickets/${ticket.serverTicketId}/result`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            status: ticket.status,
                            winAmount: ticket.winAmount,
                            matchedNumbers: ticket.matchedNumbers
                        })
                    });
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –±–∏–ª–µ—Ç–∞:', error);
                }
            }

            // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ====================

            generateTicketId() {
                const timestamp = Date.now();
                const random = Math.floor(Math.random() * 1000);
                return parseInt(`${timestamp}${random}`.slice(-9));
            }

            generateWinningNumbers() {
                const numbers = [];
                while (numbers.length < 6) {
                    const num = Math.floor(Math.random() * GAME_CONFIG.totalNumbers) + 1;
                    if (!numbers.includes(num)) {
                        numbers.push(num);
                    }
                }
                return numbers.sort((a, b) => a - b);
            }

            formatTicketId(id) {
                const str = id.toString().padStart(9, '0');
                return `#${str.slice(0, 3)} ${str.slice(3, 6)} ${str.slice(6, 9)}`;
            }

            formatTirajId(id) {
                return id.toString().padStart(3, '0');
            }

            updateTimerDisplay(status, seconds) {
                const timerElement = document.getElementById('countdownTimer');
                if (!timerElement) return;

                if (status === 'drawing') {
                    const mins = Math.floor(seconds / 60);
                    const secs = Math.floor(seconds % 60);
                    timerElement.innerHTML = `üé∞ –†–æ–∑—ã–≥—Ä—ã—à: <span style="color:#ff4757">${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}</span>`;
                } else {
                    const mins = Math.floor(seconds / 60);
                    const secs = Math.floor(seconds % 60);
                    timerElement.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                }
            }

            updateCurrentTirajDisplay() {
                const tirajElement = document.getElementById('currentTiraj');
                if (tirajElement && this.currentTiraj) {
                    const statusText = this.drawStatus === 'drawing' ? ' (–†–û–ó–´–ì–†–´–®)' : '';
                    tirajElement.textContent = `‚Ññ ${this.formatTirajId(this.currentTiraj.id)}${statusText}`;
                }
            }

            updateJackpotDisplay() {
                const jackpotElement = document.getElementById('jackpotAmount');
                if (jackpotElement) {
                    jackpotElement.innerHTML = `${Math.round(this.jackpotAmount).toLocaleString()} <span class="star-icon">‚òÖ</span>`;
                }
            }

            updateTicketsDisplay() {
                const carousel = document.getElementById('ticketsCarousel');
                if (!carousel) return;

                if (this.userTickets.length === 0) {
                    carousel.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.5); width: 100%;">
                            –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –±–∏–ª–µ—Ç–æ–≤.<br>
                            –ù–∞–∂–º–∏—Ç–µ "–ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç" –¥–ª—è —É—á–∞—Å—Ç–∏—è –≤ —Ç–∏—Ä–∞–∂–µ!
                        </div>
                    `;
                    return;
                }

                carousel.innerHTML = '';

                this.userTickets.forEach(ticket => {
                    const ticketElement = this.createTicketElement(ticket);
                    carousel.appendChild(ticketElement);
                });
            }

            async loadTirajHistory() {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/v1/tiraj/history`);
                    if (response.ok) {
                        const history = await response.json();
                        console.log('üìä –ò—Å—Ç–æ—Ä–∏—è —Ç–∏—Ä–∞–∂–µ–π:', history.length);
                        return history;
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–∏—Ä–∞–∂–µ–π:', error);
                }
                return [];
            }

            // ==================== –õ–û–ö–ê–õ–¨–ù–û–ï –°–û–•–†–ê–ù–ï–ù–ò–ï ====================

            saveLocalTickets() {
                try {
                    const data = {
                        userTickets: this.userTickets,
                        lastTirajId: this.currentTiraj?.id,
                        jackpot: this.jackpotAmount
                    };
                    localStorage.setItem('classic6_45_tickets', JSON.stringify(data));
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤:', error);
                }
            }

            loadLocalTickets() {
                try {
                    const saved = localStorage.getItem('classic6_45_tickets');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.userTickets = data.userTickets || [];
                        this.jackpotAmount = data.jackpot || GAME_CONFIG.initialJackpot;
                        return true;
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–ª–µ—Ç–æ–≤:', error);
                }
                return false;
            }

            // ==================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ====================

            checkTelegramEnvironment() {
                if (window.Telegram && Telegram.WebApp) {
                    this.isTelegramApp = true;
                    document.body.classList.add('telegram-mini-app');
                }
            }

            getAuthToken() {
                // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ localStorage –∏–ª–∏ Telegram WebApp
                if (this.isTelegramApp) {
                    return localStorage.getItem('telegram_auth_token');
                }
                return null;
            }

            initNumberGrid() {
                const grid = document.getElementById('numbersGrid');
                if (!grid) return;

                grid.innerHTML = '';

                for (let i = 1; i <= GAME_CONFIG.totalNumbers; i++) {
                    const button = document.createElement('button');
                    button.className = 'number-btn';
                    button.textContent = i;
                    button.dataset.number = i;
                    button.addEventListener('click', () => this.toggleNumber(i));
                    grid.appendChild(button);
                }
            }

            toggleNumber(number) {
                if (this.selectedNumbers.has(number)) {
                    this.selectedNumbers.delete(number);
                } else {
                    if (this.selectedNumbers.size >= GAME_CONFIG.numbersToSelect) {
                        this.showNotification(`–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ ${GAME_CONFIG.numbersToSelect} —á–∏—Å–µ–ª`);
                        return;
                    }
                    this.selectedNumbers.add(number);
                }

                this.updateNumberButtons();
                this.updateSelectionCounter();
            }

            updateNumberButtons() {
                const buttons = document.querySelectorAll('.number-btn');
                buttons.forEach(btn => {
                    const num = parseInt(btn.dataset.number);
                    btn.classList.toggle('selected', this.selectedNumbers.has(num));
                });
            }

            updateSelectionCounter() {
                const counter = document.getElementById('selectedNumbersCounter');
                if (counter) {
                    const count = this.selectedNumbers.size;
                    counter.textContent = `–í—ã–±—Ä–∞–Ω–æ: ${count}/${GAME_CONFIG.numbersToSelect}`;
                    counter.style.color = count === GAME_CONFIG.numbersToSelect ? '#4CAF50' :
                        count > 0 ? '#FFD700' : '#f44336';
                }
            }

            quickPick() {
                this.selectedNumbers.clear();
                const allNumbers = Array.from({ length: GAME_CONFIG.totalNumbers }, (_, i) => i + 1);
                const shuffled = this.shuffleArray(allNumbers);

                for (let i = 0; i < GAME_CONFIG.numbersToSelect; i++) {
                    this.selectedNumbers.add(shuffled[i]);
                }

                this.updateNumberButtons();
                this.updateSelectionCounter();
                this.showNotification('üé≤ –í—ã–±—Ä–∞–Ω—ã —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞!');
            }

            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            clearSelection() {
                this.selectedNumbers.clear();
                this.updateNumberButtons();
                this.updateSelectionCounter();
                this.showNotification('üóëÔ∏è –í—ã–±–æ—Ä –æ—á–∏—â–µ–Ω!');
            }

            showNotification(message) {
                console.log('üîî', message);

                if (this.isTelegramApp && window.Telegram?.WebApp) {
                    Telegram.WebApp.showAlert(message);
                } else {
                    alert(message);
                }
            }

            createTicketElement(ticket) {
                const div = document.createElement('div');
                div.className = 'ticket-card fade-in';

                const drawTime = new Date(ticket.drawTime);
                const timeStr = drawTime.toLocaleTimeString('ru-RU', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                let statusText = '';
                let statusClass = '';

                if (ticket.status === 'win') {
                    statusText = `üéâ –° –≤—ã–∏–≥—Ä—ã—à–µ–º (${ticket.winAmount} ‚òÖ)`;
                    statusClass = 'status-win';
                } else if (ticket.status === 'lose') {
                    statusText = '‚ùå –ë–µ–∑ –≤—ã–∏–≥—Ä—ã—à–∞';
                    statusClass = 'status-lose';
                } else {
                    statusText = '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —Ç–∏—Ä–∞–∂–∞';
                    statusClass = 'status-pending';
                }

                div.innerHTML = `
                    <div class="ticket-header">
                        <div class="ticket-id">–ë–∏–ª–µ—Ç: ${ticket.formattedId}</div>
                        <div class="tiraj-id">–¢–∏—Ä–∞–∂: ${ticket.formattedTirajId}</div>
                    </div>

                    <div class="ticket-numbers">
                        ${ticket.numbers.map(num => {
                            const isWinning = ticket.winningNumbers.includes(num);
                            const isSelected = ticket.matchedNumbers.includes(num);
                            let className = 'ticket-number';
                            if (isSelected) className += ' winning';
                            else if (ticket.status !== 'pending') className += ' selected';

                            return `<div class="${className}">${num}</div>`;
                        }).join('')}
                    </div>

                    <div class="ticket-status ${statusClass}">
                        ${statusText}
                    </div>

                    <div class="ticket-draw-time">
                        –¢–∏—Ä–∞–∂: ${timeStr}
                    </div>
                `;

                return div;
            }

            showWinResult(ticket) {
                const modal = document.getElementById('winModal');
                if (!modal) return;

                document.getElementById('winTicketId').textContent = ticket.formattedId;
                document.getElementById('winTirajId').textContent = `‚Ññ ${ticket.formattedTirajId}`;
                document.getElementById('winUserNumbers').textContent = ticket.numbers.join(', ');
                document.getElementById('winWinningNumbers').textContent = ticket.winningNumbers.join(', ');
                document.getElementById('winMatches').textContent = `${ticket.matchedNumbers.length} –∏–∑ 6`;
                document.getElementById('winAmount').textContent = `${ticket.winAmount} ‚òÖ`;

                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';

                if (typeof playWinSound === 'function') {
                    playWinSound();
                }
            }

            showLoseResult(ticket) {
                const modal = document.getElementById('loseModal');
                if (!modal) return;

                document.getElementById('loseTicketId').textContent = ticket.formattedId;
                document.getElementById('loseTirajId').textContent = `‚Ññ ${ticket.formattedTirajId}`;
                document.getElementById('loseUserNumbers').textContent = ticket.numbers.join(', ');
                document.getElementById('loseWinningNumbers').textContent = ticket.winningNumbers.join(', ');
                document.getElementById('loseMatches').textContent = `${ticket.matchedNumbers.length} –∏–∑ 6`;

                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';

                if (typeof playLoseSound === 'function') {
                    playLoseSound();
                }
            }

            updateUI() {
                this.updateTicketsDisplay();
                this.updateSelectionCounter();
                this.updateJackpotDisplay();
            }
        }

        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        let game = null;

        async function initGame() {
            if (!game) {
                game = new Classic6_45Continuous();
                await game.init();
            }
            return game;
        }

        function showNumbersModal() {
            const modal = document.getElementById('numbersModal');
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
                if (game) game.updateSelectionCounter();
            }
        }

        function hideNumbersModal() {
            const modal = document.getElementById('numbersModal');
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        function hideResultModal() {
            const winModal = document.getElementById('winModal');
            const loseModal = document.getElementById('loseModal');

            if (winModal) winModal.style.display = 'none';
            if (loseModal) loseModal.style.display = 'none';

            document.body.style.overflow = 'auto';
        }

        function quickPick() {
            if (game) game.quickPick();
        }

        function clearSelection() {
            if (game) game.clearSelection();
        }

        async function buyTicket() {
            if (game) await game.buyTicket();
        }

        function buyNewTicket() {
            hideResultModal();
            setTimeout(() => showNumbersModal(), 300);
        }

        function showMyTickets() {
            const carousel = document.getElementById('ticketsCarousel');
            if (carousel && carousel.firstElementChild) {
                carousel.firstElementChild.scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest',
                    inline: 'start'
                });
            }
        }

        function showRules() {
            const modal = document.getElementById('rulesModal');
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        function hideRules() {
            const modal = document.getElementById('rulesModal');
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        function hidePreloader() {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                preloader.classList.add('hidden');
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 300);
            }
        }

        // –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        function playWinSound() {
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
                audio.play();
            } catch (e) {
                console.log('üîä –ó–≤—É–∫ –≤—ã–∏–≥—Ä—ã—à–∞');
            }
        }

        function playLoseSound() {
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
                audio.play();
            } catch (e) {
                console.log('üîä –ó–≤—É–∫ –ø—Ä–æ–∏–≥—Ä—ã—à–∞');
            }
        }

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        (async function () {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã Classic 6/45 —Å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º–∏ —Ç–∏—Ä–∞–∂–∞–º–∏...');

            setTimeout(hidePreloader, 1000);

            await initGame();
            hidePreloader();

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            window.addEventListener('click', (event) => {
                const numbersModal = document.getElementById('numbersModal');
                const rulesModal = document.getElementById('rulesModal');
                const winModal = document.getElementById('winModal');
                const loseModal = document.getElementById('loseModal');

                if (event.target === numbersModal) hideNumbersModal();
                if (event.target === rulesModal) hideRules();
                if (event.target === winModal || event.target === loseModal) hideResultModal();
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape') {
                    hideNumbersModal();
                    hideRules();
                    hideResultModal();
                }
            });

            console.log('‚úÖ –ò–≥—Ä–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
        })();
    </script>
</body>
</html>
